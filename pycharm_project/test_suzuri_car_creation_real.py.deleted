#!/usr/bin/env python
import os
import django
import sys

# Djangoãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‘ã‚¹ã‚’è¿½åŠ 
sys.path.append('/app')

# Djangoè¨­å®š
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'django_project.settings')
django.setup()

from api.services.suzuri_api_service import SuzuriAPIService

def test_real_suzuri_car_creation():
    """å®Ÿéš›ã®SUZURI APIã§è»Šã®ç”»åƒã‹ã‚‰ã‚°ãƒƒã‚ºã‚’ä½œæˆã™ã‚‹"""
    print("ğŸš— å®Ÿéš›ã®SUZURI API ã§è»Šã®ã‚°ãƒƒã‚ºä½œæˆãƒ†ã‚¹ãƒˆé–‹å§‹")
    print("=" * 60)
    
    # APIã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆæœŸåŒ–
    try:
        suzuri_service = SuzuriAPIService()
        print("âœ… SUZURI API ã‚µãƒ¼ãƒ“ã‚¹åˆæœŸåŒ–å®Œäº†")
        print(f"ğŸ”‘ API Token: {suzuri_service.api_token[:10]}...{suzuri_service.api_token[-5:]}")
        print(f"ğŸŒ Base URL: {suzuri_service.base_url}")
        print(f"ğŸ­ Demo Mode: {suzuri_service.demo_mode}")
        
    except Exception as e:
        print(f"âŒ SUZURI API ã‚µãƒ¼ãƒ“ã‚¹åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: {str(e)}")
        return False
    
    # ãƒ†ã‚¹ãƒˆç”¨ã®è»Šç”»åƒURLï¼ˆå…¬é–‹ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªç”»åƒï¼‰
    test_image_url = "https://images.unsplash.com/photo-1503376780353-7e6692767b70?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80"
    car_name = "ãƒ†ã‚¹ãƒˆç”¨è»Šä¸¡"
    description = "AISHA AIç”»åƒç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®ãƒ†ã‚¹ãƒˆä½œæˆã§ã™ã€‚"
    item_type = "heavyweight-t-shirt"
    
    print(f"\nğŸ› ï¸ ã‚°ãƒƒã‚ºä½œæˆãƒ†ã‚¹ãƒˆ:")
    print(f"  ğŸ“¸ Image URL: {test_image_url}")
    print(f"  ğŸš— Car Name: {car_name}")
    print(f"  ğŸ“ Description: {description}")
    print(f"  ğŸ‘• Item Type: {item_type}")
    
    try:
        print("\nâ³ SUZURI API ã§ã‚°ãƒƒã‚ºä½œæˆä¸­...")
        result = suzuri_service.create_car_merchandise(
            image_url=test_image_url,
            car_name=car_name,
            description=description,
            item_type=item_type
        )
        
        print(f"\nğŸ“‹ SUZURI API å¿œç­”:")
        print(f"  Success: {result.get('success')}")
        
        if result.get('success'):
            print(f"âœ… ã‚°ãƒƒã‚ºä½œæˆæˆåŠŸï¼")
            
            # å•†å“æƒ…å ±ã‚’è¡¨ç¤º
            product = result.get('product', {})
            print(f"\nğŸ“¦ ä½œæˆã•ã‚ŒãŸå•†å“:")
            print(f"  ğŸ†” Product ID: {product.get('id')}")
            print(f"  ğŸ“ Title: {product.get('title')}")